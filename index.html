<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•©ê²©ì˜ ì‹  v11.1 : ë§ˆìŠ¤í„°í”¼ìŠ¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gaegu:wght@400;700&family=Jua&family=Noto+Sans+KR:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .font-game { font-family: 'Jua', sans-serif; }
        .font-cute { font-family: 'Gaegu', cursive; }
        
        /* Animations */
        .slide-in { animation: slideIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .pop-in { animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .bounce-slow { animation: bounce 2s infinite; }
        .float { animation: float 3s ease-in-out infinite; }
        .wiggle { animation: wiggle 2s linear infinite; }
        
        @keyframes slideIn { from { opacity: 0; transform: translateY(50px) scale(0.9); } to { opacity: 1; transform: translateY(0) scale(1); } }
        @keyframes popIn { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes float { 0% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-15px) rotate(2deg); } 100% { transform: translateY(0px) rotate(0deg); } }
        @keyframes wiggle { 0%, 100% { transform: rotate(-3deg); } 50% { transform: rotate(3deg); } }
        
        .university-card:hover { transform: translateY(-4px); box-shadow: 0 15px 30px -10px rgba(0, 0, 0, 0.1); }
        .hidden-section { display: none !important; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #fff0f5; border-radius: 10px; }
        ::-webkit-scrollbar-thumb { background: #fbcfe8; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #f472b6; }

        .bg-cute-pattern {
            background-color: #fff5f7;
            background-image: radial-gradient(#fbcfe8 2px, transparent 2px), radial-gradient(#bae6fd 2px, transparent 2px);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
        }
        /* Army Theme */
        .bg-army {
            background-color: #4b5320;
            background-image: repeating-linear-gradient(45deg, #3b421a 25%, transparent 25%, transparent 75%, #3b421a 75%, #3b421a), repeating-linear-gradient(45deg, #3b421a 25%, #4b5320 25%, #4b5320 75%, #3b421a 75%, #3b421a);
            background-position: 0 0, 10px 10px;
            background-size: 20px 20px;
        }
        
        .shadow-cute { box-shadow: 8px 8px 0px 0px rgba(249, 168, 212, 0.5); }
        .btn-push:active { transform: translateY(4px); box-shadow: none; }
        
        /* Practical Test Styles */
        .reaction-box { transition: background-color 0.1s; cursor: pointer; }
        .reaction-waiting { background-color: #fca5a5; }
        .reaction-ready { background-color: #86efac; }

        /* Recommendation Badge */
        .ai-recommend {
            animation: pulse 2s infinite;
            background: linear-gradient(45deg, #ff6b6b, #f06595);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        /* Score Change Badge */
        .score-change {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .score-up { background-color: #d1fae5; color: #166534; }
        .score-down { background-color: #fee2e2; color: #991b1b; }
    </style>
</head>
<body class="text-slate-800 min-h-screen flex flex-col bg-cute-pattern transition-colors duration-500" id="main-body">

    <!-- Header -->
    <header class="bg-white/90 backdrop-blur-md text-pink-600 p-3 sticky top-0 z-50 border-b-4 border-pink-200 transition-colors duration-500" id="main-header">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-2">
            <h1 class="text-2xl md:text-3xl font-game flex items-center tracking-wider cursor-pointer drop-shadow-sm hover:scale-105 transition" onclick="location.reload()">
                <span class="text-3xl mr-2">ğŸ‘‘</span>í•©ê²©ì˜ ì‹  v11.1
            </h1>
            <div id="status-bar" class="hidden text-xs md:text-sm flex flex-wrap justify-center gap-3 transition-all duration-300 font-bold font-game">
                <span class="bg-yellow-100 px-3 py-1 rounded-full border-2 border-yellow-300 text-yellow-700"><i class="fas fa-user mr-1"></i> <span id="display-name"></span></span>
                <span class="bg-blue-100 px-3 py-1 rounded-full border-2 border-blue-300 text-blue-700"><i class="fas fa-graduation-cap mr-1"></i> <span id="display-major"></span></span>
                <span class="bg-green-100 px-3 py-1 rounded-full border-2 border-green-300 text-green-700"><i class="fas fa-book-open mr-1"></i> ë‚´ì‹ : <span id="display-gpa">0.00</span></span>
                <span class="bg-purple-100 px-3 py-1 rounded-full border-2 border-purple-300 text-purple-700"><i class="fas fa-chart-line mr-1"></i> ìˆ˜ëŠ¥: <span id="display-sat">0</span>%</span>
                <span id="combo-badge" class="hidden bg-red-100 px-3 py-1 rounded-full border-2 border-red-400 text-red-600 animate-pulse"></span>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 flex-grow relative flex flex-col justify-center items-center">
        
        <!-- Scene 1: Intro -->
        <section id="scene-intro" class="max-w-lg w-full relative slide-in z-10 mt-6">
            <div class="absolute -top-12 -left-8 text-7xl float" style="animation-delay: 0s; z-index: -1;">ğŸŒˆ</div>
            <div class="absolute top-20 -right-12 text-6xl float" style="animation-delay: 1s; z-index: -1;">ğŸ¦„</div>

            <div class="bg-white p-8 rounded-[3rem] border-4 border-pink-300 shadow-cute text-center relative overflow-hidden">
                <div class="bg-pink-100 absolute top-0 left-0 w-full h-6"></div>
                
                <div id="intro-badge" class="mt-4 mb-4 relative inline-block">
                     <div class="w-32 h-32 bg-gradient-to-t from-pink-200 to-white rounded-full flex items-center justify-center mx-auto border-4 border-pink-300 shadow-inner">
                        <i class="fas fa-graduation-cap text-6xl text-pink-500 bounce-slow"></i>
                    </div>
                </div>

                <h1 class="text-4xl font-game text-pink-500 mb-1 tracking-tight drop-shadow-sm" id="game-title">í•©ê²©ì˜ ì‹ </h1>
                <h2 class="text-2xl font-cute text-slate-500 mb-8" id="game-subtitle">ë‚˜ëŠ” ì–´ë””ë¡œ ê°ˆê¹Œ? ğŸ«ğŸƒâ€â™‚ï¸</h2>

                <!-- Penalty Alert Box (Initially Hidden) -->
                <div id="penalty-alert" class="hidden mb-6 p-4 rounded-2xl text-sm font-bold border-2 animate-pulse text-left font-game shadow-md"></div>

                <form id="profile-form" class="space-y-4 text-left font-game">
                    <div class="grid grid-cols-2 gap-3">
                        <div class="group">
                            <label class="block text-sm text-pink-400 mb-1 ml-2">ì´ë¦„</label>
                            <input type="text" id="input-name" class="w-full bg-slate-50 border-2 border-pink-200 p-3 rounded-2xl focus:border-pink-400 outline-none text-center text-lg shadow-sm" placeholder="ê¹€ì…ì‹œ" required>
                        </div>
                        <div class="group">
                            <label class="block text-sm text-pink-400 mb-1 ml-2">ì¶œì‹  ê³ êµ</label>
                            <input type="text" id="input-school" class="w-full bg-slate-50 border-2 border-pink-200 p-3 rounded-2xl focus:border-pink-400 outline-none text-center text-lg shadow-sm" placeholder="OOê³ " required>
                        </div>
                    </div>
                    
                    <div class="group">
                        <label class="block text-sm text-pink-400 mb-1 ml-2">í¬ë§ í•™ê³¼ (ë©´ì ‘ ë°˜ì˜)</label>
                        <input type="text" id="input-major" class="w-full bg-slate-50 border-2 border-pink-200 p-3 rounded-2xl focus:border-pink-400 outline-none text-center text-lg shadow-sm" placeholder="ì˜ˆ: ì»´í“¨í„°ê³µí•™ê³¼, ê²½ì˜í•™ê³¼" required>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm text-pink-400 mb-1 ml-2">ì„±ë³„</label>
                            <select id="input-gender" class="w-full bg-slate-50 border-2 border-pink-200 p-3 rounded-2xl focus:border-pink-400 outline-none text-center text-lg shadow-sm">
                                <option value="M">ë‚¨ì„± ğŸ‘¦</option>
                                <option value="F">ì—¬ì„± ğŸ‘§</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm text-pink-400 mb-1 ml-2">ê³„ì—´</label>
                            <select id="input-track" class="w-full bg-slate-50 border-2 border-pink-200 p-3 rounded-2xl focus:border-pink-400 outline-none text-center text-lg shadow-sm">
                                <option value="ì¸ë¬¸">ì¸ë¬¸ê³„ì—´ ğŸ“š</option>
                                <option value="ìì—°">ìì—°ê³„ì—´ ğŸ”¬</option>
                                <option value="ì˜ˆì²´ëŠ¥">ì˜ˆì²´ëŠ¥ ğŸ¨</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label class="block text-sm text-pink-400 mb-1 ml-2">ë‚´ì‹  (1.0~9.0)</label>
                            <input type="number" id="input-gpa" step="0.1" min="1.0" max="9.0" class="w-full bg-slate-50 border-2 border-pink-200 p-3 rounded-2xl focus:border-pink-400 outline-none text-center text-lg shadow-sm" placeholder="3.5" required>
                        </div>
                        <div>
                            <label class="block text-sm text-pink-400 mb-1 ml-2">ëª¨ì˜ê³ ì‚¬ (%)</label>
                            <input type="number" id="input-sat" min="0" max="100" class="w-full bg-slate-50 border-2 border-pink-200 p-3 rounded-2xl focus:border-pink-400 outline-none text-center text-lg shadow-sm" placeholder="85" required>
                        </div>
                    </div>
                    <button type="submit" id="start-btn" class="w-full bg-pink-400 hover:bg-pink-500 text-white font-black py-4 rounded-2xl shadow-[0_6px_0_rgb(219,39,119)] active:shadow-none active:translate-y-[6px] transition-all text-xl mt-4 flex justify-center items-center gap-2 btn-push">
                        START! ğŸš€
                    </button>
                </form>

                <div class="mt-8 pt-4 border-t-2 border-dashed border-pink-100 text-xs text-pink-300 font-bold">
                    Created by Yoo Won Seok
                </div>
            </div>
        </section>

        <!-- Scene 2: Quiz -->
        <section id="scene-quiz" class="hidden-section max-w-2xl w-full mx-auto slide-in">
            <div class="bg-white rounded-[2rem] shadow-cute border-4 border-slate-800 overflow-hidden">
                <div class="bg-slate-800 p-6 text-white flex justify-between items-center" id="quiz-header">
                    <div>
                        <h3 class="font-bold text-2xl font-game text-yellow-300"><i class="fas fa-brain mr-2"></i><span id="quiz-title">ë‘ë‡Œ í’€ê°€ë™!</span></h3>
                        <p class="text-sm font-cute text-slate-300">ì—°ì† ì •ë‹µ ì‹œ ì ìˆ˜ê°€ íŒíŒ ì˜¬ë¼ìš”!</p>
                    </div>
                    <span class="text-lg font-black bg-white/20 px-4 py-2 rounded-xl">Q <span id="current-round">1</span>/<span id="total-rounds">5</span></span>
                </div>
                
                <div class="p-8">
                    <div class="mb-8">
                        <span id="quiz-subject" class="inline-block bg-yellow-100 text-yellow-800 border-2 border-yellow-200 text-sm px-3 py-1 rounded-lg mb-3 font-black font-game">Subject</span>
                        <h2 id="quiz-question" class="text-2xl font-bold text-slate-800 leading-snug break-keep font-game">ë¬¸ì œ ë¡œë”©ì¤‘...</h2>
                    </div>
                    <div id="quiz-options" class="grid grid-cols-1 gap-3 font-game text-lg"></div>
                </div>
                
                <div id="quiz-feedback" class="hidden bg-slate-50 p-8 border-t-4 border-slate-100 text-center pop-in">
                    <div id="feedback-icon" class="text-6xl mb-4 inline-block bounce-slow"></div>
                    <p id="feedback-text" class="font-bold text-2xl mb-2 text-slate-700 font-game"></p>
                    <div id="feedback-detail" class="mb-6"></div> <!-- Visual Score Change -->
                    <button id="next-quiz-btn" class="bg-slate-800 text-white px-10 py-3 rounded-2xl hover:bg-black font-bold shadow-lg transition transform hover:scale-105 font-game text-xl">ë‹¤ìŒ ë¬¸ì œ <i class="fas fa-arrow-right ml-1"></i></button>
                </div>
            </div>
        </section>

        <!-- Scene 3: Susi Application -->
        <section id="scene-susi" class="hidden-section slide-in w-full max-w-6xl">
            <div class="text-center mb-8">
                <span class="bg-blue-100 text-blue-700 px-4 py-1 rounded-full text-sm font-black mb-2 inline-block font-game border-2 border-blue-200">STEP 1</span>
                <h2 class="text-4xl font-black text-slate-800 font-game">ìˆ˜ì‹œ ì›ì„œ ì ‘ìˆ˜</h2>
                <p class="text-sm text-slate-500 mt-2 font-bold font-game">* <span class="text-blue-600 bg-blue-50 px-1 rounded">AI ì¶”ì²œ</span> ë§ˆí¬ê°€ ìˆëŠ” ê³³ì„ ë…¸ë ¤ë³´ì„¸ìš”!</p>
            </div>

            <div class="flex flex-col lg:flex-row gap-6 h-auto lg:h-[600px]">
                <div class="lg:w-2/3 flex flex-col h-[500px] lg:h-full bg-white rounded-[2rem] shadow-lg p-6 border-4 border-slate-100">
                    <div class="flex gap-2 mb-4 overflow-x-auto pb-2 flex-shrink-0 scrollbar-hide font-game">
                        <button class="filter-btn active bg-slate-800 text-white px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap transition shadow-md" data-filter="all">ì „ì²´</button>
                        <button class="filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="sky">SKY</button>
                        <button class="filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="in_seoul_top">ì¸ì„œìš¸ ìƒìœ„</button>
                        <button class="filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="in_seoul_mid">ì¸ì„œìš¸/ìˆ˜ë„ê¶Œ</button>
                        <button class="filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="jigeoguk">ì§€ê±°êµ­</button>
                        <button class="filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-full text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="metro_low">ê²½ê¸°/ì¶©ì²­ê¶Œ</button>
                    </div>
                    <div id="susi-uni-list" class="grid grid-cols-1 md:grid-cols-2 gap-3 overflow-y-auto pr-2 pb-2"></div>
                </div>

                <div class="lg:w-1/3 flex flex-col h-auto lg:h-full bg-white rounded-[2rem] shadow-cute p-6 border-4 border-blue-200 relative">
                    <div class="absolute -top-4 -right-4 bg-red-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-black text-xl shadow-md z-10 bounce-slow" id="susi-badge">0</div>
                    <h3 class="font-bold text-2xl text-slate-800 font-game mb-4 border-b-2 border-dashed border-blue-100 pb-2">ğŸ“‚ ë‚´ ì›ì„œí•¨</h3>
                    <div class="flex-grow overflow-y-auto bg-blue-50 rounded-xl p-3 mb-4 inner-shadow min-h-[150px] lg:min-h-0">
                        <ul id="susi-cart" class="space-y-2 text-sm font-game">
                            <li class="text-center py-20 text-blue-300 text-base flex flex-col items-center">
                                ëŒ€í•™ì„ ì„ íƒí•´ì£¼ì„¸ìš”!
                            </li>
                        </ul>
                    </div>
                    <button id="btn-susi-submit" class="w-full bg-slate-200 text-slate-400 font-black py-4 rounded-xl transition-all shadow-none cursor-not-allowed text-xl font-game" disabled>
                        ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”
                    </button>
                </div>
            </div>
        </section>

        <!-- Scene 4: Exam Intro -->
        <section id="scene-exam-intro" class="hidden-section max-w-lg mx-auto slide-in mt-10 w-full text-center">
            <div class="bg-white p-10 rounded-[3rem] shadow-cute border-4 border-slate-800 relative overflow-hidden">
                <i class="fas fa-pencil-alt text-7xl text-yellow-400 mb-6 bounce-slow block drop-shadow-md"></i>
                <h2 class="text-4xl font-black text-slate-800 font-game mb-4">ëŒ€í•™ë³„ ê³ ì‚¬</h2>
                <p class="text-slate-500 text-xl mb-8 font-cute">ë§ˆì§€ë§‰ ì—­ì „ì˜ ê¸°íšŒ!<br>ë©´ì ‘ê³¼ ë…¼ìˆ ì—ì„œ ì‹¤ë ¥ì„ ë³´ì—¬ì£¼ì„¸ìš”.</p>
                <button onclick="startActualExams()" class="bg-indigo-600 text-white px-12 py-5 rounded-2xl font-black hover:bg-indigo-700 shadow-[0_6px_0_rgb(55,48,163)] active:shadow-none active:translate-y-[6px] transition text-2xl font-game">
                    ì…ì¥í•˜ê¸° ğŸšª
                </button>
            </div>
        </section>

        <!-- Scene 4-1: Interview Game -->
        <section id="scene-interview" class="hidden-section max-w-2xl mx-auto slide-in mt-10 w-full">
            <div class="bg-white rounded-[2rem] shadow-xl p-8 border-4 border-green-200">
                <div class="text-center mb-6">
                    <span class="bg-green-100 text-green-700 px-4 py-1 rounded-lg text-sm font-bold mb-3 inline-block font-game">ì¢…í•©ì „í˜• ë©´ì ‘</span>
                    <h3 class="text-3xl font-bold text-slate-800 font-game">ğŸ’¬ ì‹¬ì¸µ ë©´ì ‘ (3ë‹¨ê³„)</h3>
                    <div class="flex justify-center gap-2 mt-2">
                         <div id="interview-step-1" class="w-3 h-3 rounded-full bg-slate-300 transition"></div>
                         <div id="interview-step-2" class="w-3 h-3 rounded-full bg-slate-300 transition"></div>
                         <div id="interview-step-3" class="w-3 h-3 rounded-full bg-slate-300 transition"></div>
                    </div>
                </div>
                <div id="interview-content" class="bg-green-50 p-8 rounded-2xl border-2 border-green-100 font-game text-lg"></div>
            </div>
        </section>

        <!-- Scene 4-2: Essay Game -->
        <section id="scene-essay" class="hidden-section max-w-2xl mx-auto slide-in mt-10 w-full">
            <div class="bg-white rounded-[2rem] shadow-xl p-8 border-4 border-purple-200">
                <div class="text-center mb-8">
                    <span class="bg-purple-100 text-purple-700 px-4 py-1 rounded-lg text-sm font-bold mb-3 inline-block font-game">ë…¼ìˆ ì „í˜•</span>
                    <h3 class="text-3xl font-bold text-slate-800 font-game">âœï¸ ê³ ë‚œë„ ë…¼ìˆ  ê³ ì‚¬</h3>
                </div>
                <div id="essay-content" class="bg-purple-50 p-8 rounded-2xl border-2 border-purple-100 font-game text-lg"></div>
            </div>
        </section>

        <!-- Scene 4-3: Arts Practical -->
        <section id="scene-practical" class="hidden-section max-w-2xl mx-auto slide-in mt-10 w-full text-center">
            <div class="bg-white rounded-[2rem] shadow-xl p-8 border-4 border-orange-200">
                <div class="text-center mb-6">
                    <span class="bg-orange-100 text-orange-700 px-4 py-1 rounded-lg text-sm font-bold mb-3 inline-block font-game">ì˜ˆì²´ëŠ¥ ì‹¤ê¸°</span>
                    <h3 class="text-3xl font-bold text-slate-800 font-game">âš¡ ìˆœë°œë ¥ í…ŒìŠ¤íŠ¸</h3>
                    <p class="text-slate-500 mt-2 font-cute text-xl">ì´ˆë¡ìƒ‰ì´ ë˜ë©´ í´ë¦­í•˜ì„¸ìš”!</p>
                </div>
                <div id="reaction-area" class="reaction-box reaction-waiting h-64 rounded-3xl flex items-center justify-center text-white text-3xl font-black font-game shadow-inner transform active:scale-95 transition" onclick="handleReactionClick()">
                    ì¤€ë¹„...
                </div>
                <div id="reaction-result" class="mt-4 text-2xl font-bold text-slate-800 font-game"></div>
                <button id="practical-next-btn" class="hidden mt-6 bg-slate-800 text-white px-8 py-3 rounded-xl hover:bg-black transition font-game">ë‹¤ìŒìœ¼ë¡œ</button>
            </div>
        </section>

        <!-- Scene 5: Susi Result -->
        <section id="scene-susi-result" class="hidden-section max-w-6xl mx-auto slide-in w-full">
            <div class="bg-white rounded-[2.5rem] shadow-xl p-10 text-center min-h-[600px] flex flex-col justify-center relative border-8 border-blue-50">
                <h2 class="text-4xl font-black mb-6 text-slate-800 font-game">ğŸ‰ ìˆ˜ì‹œ í•©ê²©ì ë°œí‘œ ğŸ‰</h2>
                <div id="susi-result-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mb-10"></div>
                
                <div id="susi-outcome-controls" class="hidden border-t-2 border-dashed border-slate-200 pt-10">
                    <div id="susi-pass-msg" class="hidden">
                        <p class="text-3xl font-bold text-green-600 mb-2 font-game animate-bounce">ì¶•í•˜í•©ë‹ˆë‹¤! í•©ê²©!</p>
                        <p class="text-slate-500 font-cute text-xl mb-8">ì´ì œ ìµœì¢… ëŒ€í•™ì„ ì„ íƒí•  ì‹œê°„ì…ë‹ˆë‹¤.</p>
                        <button id="go-to-final-choice-susi" class="bg-slate-800 hover:bg-black text-white font-black py-4 px-12 rounded-2xl shadow-xl font-game text-xl transition hover:scale-105">
                            ìµœì¢… ë“±ë¡í•˜ê¸° âœ¨
                        </button>
                    </div>
                    <div id="susi-fail-msg" class="hidden">
                        <p class="text-2xl font-bold text-slate-500 mb-2 font-game">ì•„ì‰½ê²Œë„ ë¶ˆí•©ê²©ì…ë‹ˆë‹¤ ğŸ˜­</p>
                        <p class="text-blue-500 font-cute text-xl mb-8 font-bold">í•˜ì§€ë§Œ ì •ì‹œ ëŒ€ë°•ì´ ë‚¨ì•„ìˆì–´ìš”!</p>
                        <button id="go-to-jeongsi" class="bg-blue-500 hover:bg-blue-600 text-white font-black py-4 px-12 rounded-2xl shadow-xl font-game text-xl transition hover:scale-105">
                            ì •ì‹œ ë„ì „í•˜ê¸° ğŸ”¥
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Scene 6: Jeongsi Application -->
        <section id="scene-jeongsi" class="hidden-section slide-in w-full max-w-6xl">
            <div class="text-center mb-8">
                <span class="bg-indigo-100 text-indigo-700 px-4 py-1 rounded-full text-sm font-black mb-2 inline-block font-game border-2 border-indigo-200">STEP 2</span>
                <h2 class="text-3xl font-black text-slate-800 font-game">ì •ì‹œ ì›ì„œ ì ‘ìˆ˜</h2>
                <p class="text-slate-500 mt-2 font-bold font-game text-sm">ê°€/ë‚˜/ë‹¤êµ° ì´ 3ì¥ ì§€ì› / <span class="text-indigo-500">AI ì¶”ì²œ ì°¸ê³ </span></p>
            </div>

            <div class="flex flex-col lg:flex-row gap-6 h-auto lg:h-[600px]">
                <div class="lg:w-2/3 flex flex-col h-[500px] lg:h-full bg-white rounded-[2rem] shadow-lg p-6 overflow-hidden border-4 border-slate-100">
                    <div class="flex gap-2 mb-4 overflow-x-auto pb-2 flex-shrink-0 scrollbar-hide font-game">
                        <button class="j-filter-btn active bg-slate-800 text-white px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap transition" data-filter="all">ì „ì²´ë³´ê¸°</button>
                        <button class="j-filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="sky">SKY</button>
                        <button class="j-filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="in_seoul_top">ì¸ì„œìš¸ ìƒìœ„</button>
                        <button class="j-filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="in_seoul_mid">ì¸ì„œìš¸/ìˆ˜ë„ê¶Œ</button>
                        <button class="j-filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="jigeoguk">ì§€ê±°êµ­</button>
                        <button class="j-filter-btn bg-white border-2 border-slate-200 text-slate-500 px-4 py-2 rounded-xl text-sm font-bold whitespace-nowrap hover:bg-slate-50 transition" data-filter="metro_low">ê²½ê¸°/ì¶©ì²­ê¶Œ</button>
                    </div>
                    <div id="jeongsi-uni-list" class="grid grid-cols-1 md:grid-cols-2 gap-3 overflow-y-auto pr-2 pb-2 h-full"></div>
                </div>

                <div class="lg:w-1/3 flex flex-col h-auto lg:h-full bg-white rounded-[2rem] shadow-cute p-6 border-4 border-indigo-200 relative">
                     <div class="absolute -top-4 -right-4 bg-purple-500 text-white w-10 h-10 rounded-full flex items-center justify-center font-black text-xl shadow-md z-10 bounce-slow" id="jeongsi-badge">0</div>
                     <h3 class="font-bold text-2xl text-slate-800 font-game mb-4 border-b-2 border-dashed border-indigo-100 pb-2">ğŸ“‚ ì •ì‹œ ì›ì„œí•¨</h3>
                    <div class="flex-grow overflow-y-auto bg-indigo-50 rounded-xl p-3 mb-4 inner-shadow min-h-[150px] lg:min-h-0">
                        <ul id="jeongsi-cart" class="space-y-2 text-sm font-game">
                            <li class="text-center py-20 text-indigo-300 text-base flex flex-col items-center">
                                ëŒ€í•™ì„ ì„ íƒí•´ì£¼ì„¸ìš”!
                            </li>
                        </ul>
                    </div>
                    <button id="submit-jeongsi" disabled class="w-full bg-slate-200 text-slate-400 font-black py-4 rounded-xl transition-all shadow-none cursor-not-allowed text-xl font-game">
                        ì ‘ìˆ˜í•˜ê¸°
                    </button>
                </div>
            </div>
        </section>

        <!-- Scene 7: Jeongsi Result Announcement -->
        <section id="scene-jeongsi-announce" class="hidden-section max-w-3xl mx-auto slide-in text-center mt-10 w-full">
            <div class="bg-white p-12 rounded-[2.5rem] shadow-2xl border-4 border-indigo-100">
                <h2 class="text-4xl font-black text-slate-800 font-game mb-8">ì •ì‹œ í•©ê²©ì ë°œí‘œ</h2>
                <div class="flex justify-center mb-10" id="jeongsi-loading">
                    <i class="fas fa-spinner fa-spin text-6xl text-indigo-300"></i>
                </div>
                <div id="jeongsi-results-container" class="grid gap-4 opacity-0 transition-opacity duration-1000"></div>
                <div id="jeongsi-next-controls" class="hidden mt-10">
                    <button id="go-to-final-choice-jeongsi" class="hidden bg-indigo-600 text-white px-10 py-4 rounded-2xl font-bold hover:bg-indigo-700 shadow-xl transition transform hover:scale-105 text-lg font-game">
                        ìµœì¢… ë“±ë¡í•˜ê¸° âœ¨
                    </button>
                    <div id="jeongsi-fail-options" class="hidden">
                        <p class="text-2xl font-bold text-slate-700 mb-6 font-game">ì „ë¶€ ë¶ˆí•©ê²©í–ˆìŠµë‹ˆë‹¤..ğŸ˜­</p>
                        <div class="flex flex-col gap-3 justify-center max-w-md mx-auto font-game">
                            <button onclick="triggerJaesu()" class="bg-red-400 hover:bg-red-500 text-white px-8 py-4 rounded-2xl font-bold shadow-md transition flex items-center justify-between text-lg">
                                <span>ğŸ”¥ ì¬ìˆ˜í•˜ê¸°</span> <span class="text-sm bg-black/20 px-2 py-1 rounded">ë‚´ì‹  -0.5</span>
                            </button>
                            <button onclick="triggerGunsu()" class="bg-green-600 hover:bg-green-700 text-white px-8 py-4 rounded-2xl font-bold shadow-md transition flex items-center justify-between text-lg">
                                <span>ğŸª– êµ°ìˆ˜í•˜ê¸°</span> <span class="text-sm bg-black/20 px-2 py-1 rounded">ë‚´ì‹  -0.7 / í€´ì¦ˆ 10ê°œ</span>
                            </button>
                            <button onclick="triggerEnd('grad')" class="bg-slate-500 hover:bg-slate-600 text-white px-8 py-4 rounded-2xl font-bold shadow-md transition flex items-center justify-center text-lg">
                                ğŸ“ ì¡¸ì—…í•˜ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Scene 9: Final Selection -->
        <section id="scene-final-select" class="hidden-section max-w-3xl mx-auto slide-in text-center mt-10 w-full">
            <div class="bg-white p-10 rounded-[3rem] shadow-cute border-4 border-blue-200">
                <h2 class="text-4xl font-black text-slate-800 font-game mb-4">ìµœì¢… ëŒ€í•™ ì„ íƒ</h2>
                <p class="text-slate-500 mb-8 font-cute text-xl">í•©ê²©í•œ ëŒ€í•™ ì¤‘ <span class="text-blue-600 font-bold">ë‹¨ í•œ ê³³</span>ë§Œ ì„ íƒí•˜ì„¸ìš”!</p>
                <div id="final-candidate-list" class="grid gap-4 mb-8 font-game"></div>
            </div>
        </section>

        <!-- Scene 8: Final Certificate -->
        <section id="scene-final" class="hidden-section max-w-3xl mx-auto slide-in text-center mt-10 w-full">
            <div class="bg-white p-10 rounded-[2.5rem] shadow-2xl border-8 border-yellow-200 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-4 bg-yellow-400"></div>
                <i class="fas fa-crown text-8xl text-yellow-400 mb-6 drop-shadow-md mt-6 block bounce-slow"></i>
                <h2 class="text-5xl font-black text-slate-800 mb-2 font-game">ìµœì¢… í•©ê²©ì¦</h2>
                <div id="final-university-display" class="my-10 p-8 bg-slate-50 rounded-3xl border-2 border-slate-100 font-game"></div>
                
                <div class="bg-indigo-50 p-6 rounded-2xl text-left border border-indigo-100 shadow-inner font-game">
                    <h3 class="font-bold text-indigo-800 mb-4 border-b border-indigo-200 pb-2 text-sm"><i class="fas fa-file-invoice mr-2"></i>ìµœì¢… ë¦¬í¬íŠ¸</h3>
                    <div class="grid grid-cols-2 gap-6 text-lg">
                        <div><span class="text-indigo-400 block text-xs mb-1">ì´ë¦„</span> <span class="font-bold final-name text-slate-800"></span></div>
                        <div><span class="text-indigo-400 block text-xs mb-1">ê³ êµ</span> <span class="font-bold text-slate-800 final-school-display"></span></div>
                        <div><span class="text-indigo-400 block text-xs mb-1">ë‚´ì‹ </span> <span class="font-bold text-blue-600 final-gpa-display"></span></div>
                        <div><span class="text-indigo-400 block text-xs mb-1">ìˆ˜ëŠ¥</span> <span class="font-bold text-purple-600 final-sat-display"></span>%</div>
                    </div>
                </div>

                <button onclick="location.reload()" class="mt-12 bg-slate-800 text-white px-12 py-5 rounded-2xl hover:bg-black shadow-xl font-bold transition transform hover:scale-105 mb-4 group font-game text-xl">
                    <i class="fas fa-redo mr-2 group-hover:rotate-180 transition-transform duration-500"></i>ì²˜ìŒìœ¼ë¡œ
                </button>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-100 text-slate-400 text-center p-6 text-xs font-bold font-game">
        <p>Copyright â“’ 2026 <span class="text-pink-400">Yoo Won Seok</span>. All rights reserved.</p>
    </footer>
    
    <!-- Susi Type Modal -->
    <div id="type-modal" class="fixed inset-0 bg-black/60 hidden z-[60] flex items-center justify-center p-4 backdrop-blur-sm transition-opacity">
        <div class="bg-white rounded-[2rem] shadow-2xl max-w-sm w-full p-8 transform scale-100 transition-transform">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-3">
                    <i class="fas fa-stamp text-3xl text-blue-500"></i>
                </div>
                <h3 class="text-3xl font-black text-slate-800 font-game">ì „í˜• ì„ íƒ</h3>
                <p class="text-lg text-slate-500 mt-1 font-cute font-bold" id="modal-uni-name">ëŒ€í•™êµ</p>
                <p class="text-sm text-red-500 mt-2 font-bold bg-red-50 inline-block px-2 py-1 rounded" id="modal-uni-chojeo"></p>
            </div>
            
            <div class="space-y-3 font-game">
                <button class="type-select-btn w-full p-4 border-2 border-slate-100 rounded-2xl hover:border-blue-500 hover:bg-blue-50 transition text-left flex items-center justify-between group bg-white" data-type="êµê³¼">
                    <div>
                        <div class="font-bold text-slate-700 text-lg group-hover:text-blue-600">í•™ìƒë¶€ êµê³¼</div>
                        <div class="text-xs text-slate-400 mt-0.5">ë‚´ì‹  100% + ìµœì €</div>
                    </div>
                    <i class="fas fa-calculator text-slate-300 group-hover:text-blue-500 text-2xl"></i>
                </button>
                <button class="type-select-btn w-full p-4 border-2 border-slate-100 rounded-2xl hover:border-green-500 hover:bg-green-50 transition text-left flex items-center justify-between group bg-white" data-type="ì¢…í•©">
                    <div>
                        <div class="font-bold text-slate-700 text-lg group-hover:text-green-600">í•™ìƒë¶€ ì¢…í•©</div>
                        <div class="text-xs text-slate-400 mt-0.5">ì„œë¥˜ + ë©´ì ‘</div>
                    </div>
                    <i class="fas fa-user-tie text-slate-300 group-hover:text-green-500 text-2xl"></i>
                </button>
                <button class="type-select-btn w-full p-4 border-2 border-slate-100 rounded-2xl hover:border-purple-500 hover:bg-purple-50 transition text-left flex items-center justify-between group bg-white" data-type="ë…¼ìˆ ">
                    <div>
                        <div class="font-bold text-slate-700 text-lg group-hover:text-purple-600">ë…¼ìˆ  ì „í˜•</div>
                        <div class="text-xs text-slate-400 mt-0.5">ë‚´ì‹ â†“ + ë…¼ìˆ </div>
                    </div>
                    <i class="fas fa-pen-nib text-slate-300 group-hover:text-purple-500 text-2xl"></i>
                </button>
            </div>
            <button onclick="closeModal()" class="mt-6 w-full py-3 text-slate-400 hover:text-slate-600 font-bold transition font-game text-lg">ë‹«ê¸°</button>
        </div>
    </div>

    <script>
        // --- Global State ---
        let activeRetryMode = null; 

        // --- Sound Effects (Web Audio API) ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playSuccessSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(523.25, audioCtx.currentTime); 
            oscillator.frequency.exponentialRampToValueAtTime(1046.5, audioCtx.currentTime + 0.1); 
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.5);
        }

        function playFailSound() {
            if(audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = 'sawtooth';
            oscillator.frequency.setValueAtTime(200, audioCtx.currentTime); 
            oscillator.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.3);
        }

        // --- University Data ---
        const universities = [
            // SKY
            { id: 1, name: "ì„œìš¸ëŒ€í•™êµ", tier: "sky", cut_h: 1.15, cut_n: 1.20, jeongsi_cut: 99.0, chojeo: 96, gender:'all', logo: "fas fa-university", color: "text-blue-900" },
            { id: 2, name: "ì—°ì„¸ëŒ€í•™êµ", tier: "sky", cut_h: 1.45, cut_n: 1.50, jeongsi_cut: 97.5, chojeo: 95, gender:'all', logo: "fas fa-eagle", color: "text-blue-700" },
            { id: 3, name: "ê³ ë ¤ëŒ€í•™êµ", tier: "sky", cut_h: 1.55, cut_n: 1.60, jeongsi_cut: 97.0, chojeo: 95, gender:'all', logo: "fas fa-shield-cat", color: "text-red-800" },
            // In Seoul Top
            { id: 4, name: "ì„œê°•ëŒ€í•™êµ", tier: "in_seoul_top", cut_h: 1.65, cut_n: 1.70, jeongsi_cut: 94.5, chojeo: 92, gender:'all', logo: "fas fa-star", color: "text-red-600" },
            { id: 5, name: "ì„±ê· ê´€ëŒ€í•™êµ", tier: "in_seoul_top", cut_h: 1.70, cut_n: 1.75, jeongsi_cut: 95.0, chojeo: 92, gender:'all', logo: "fas fa-leaf", color: "text-green-700" },
            { id: 6, name: "í•œì–‘ëŒ€í•™êµ", tier: "in_seoul_top", cut_h: 1.75, cut_n: 1.80, jeongsi_cut: 94.0, chojeo: 92, gender:'all', logo: "fas fa-lion", color: "text-blue-600" },
            { id: 7, name: "ì¤‘ì•™ëŒ€í•™êµ", tier: "in_seoul_top", cut_h: 1.85, cut_n: 1.90, jeongsi_cut: 93.0, chojeo: 90, gender:'all', logo: "fas fa-building-columns", color: "text-blue-500" },
            { id: 8, name: "ê²½í¬ëŒ€í•™êµ", tier: "in_seoul_top", cut_h: 1.95, cut_n: 2.00, jeongsi_cut: 92.0, chojeo: 89, gender:'all', logo: "fas fa-globe", color: "text-red-500" },
            { id: 9, name: "í•œêµ­ì™¸êµ­ì–´ëŒ€", tier: "in_seoul_top", cut_h: 2.10, cut_n: 2.30, jeongsi_cut: 91.0, chojeo: 88, gender:'all', logo: "fas fa-earth-asia", color: "text-cyan-700" },
            { id: 10, name: "ì„œìš¸ì‹œë¦½ëŒ€", tier: "in_seoul_top", cut_h: 2.15, cut_n: 2.20, jeongsi_cut: 91.5, chojeo: 88, gender:'all', logo: "fas fa-city", color: "text-blue-900" },
            { id: 11, name: "ì´í™”ì—¬ìëŒ€", tier: "in_seoul_top", cut_h: 1.90, cut_n: 2.00, jeongsi_cut: 92.5, chojeo: 89, gender:'F', logo: "fas fa-flower", color: "text-green-800" },
            // In Seoul Mid
            { id: 12, name: "ê±´êµ­ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.20, cut_n: 2.25, jeongsi_cut: 90.0, chojeo: 87, gender:'all', logo: "fas fa-horse-head", color: "text-green-600" },
            { id: 13, name: "ë™êµ­ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.30, cut_n: 2.35, jeongsi_cut: 89.0, chojeo: 86, gender:'all', logo: "fas fa-dharmachakra", color: "text-orange-600" },
            { id: 14, name: "í™ìµëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.40, cut_n: 2.45, jeongsi_cut: 88.0, chojeo: 88, gender:'all', logo: "fas fa-palette", color: "text-blue-800" },
            { id: 15, name: "ìˆ™ëª…ì—¬ìëŒ€", tier: "in_seoul_mid", cut_h: 2.35, cut_n: 2.40, jeongsi_cut: 88.5, chojeo: 86, gender:'F', logo: "fas fa-snowflake", color: "text-blue-400" },
            { id: 16, name: "êµ­ë¯¼ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.60, cut_n: 2.70, jeongsi_cut: 86.0, chojeo: 84, gender:'all', logo: "fas fa-tree", color: "text-green-800" },
            { id: 17, name: "ìˆ­ì‹¤ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.65, cut_n: 2.60, jeongsi_cut: 86.5, chojeo: 84, gender:'all', logo: "fas fa-church", color: "text-blue-500" },
            { id: 18, name: "ì„¸ì¢…ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.70, cut_n: 2.65, jeongsi_cut: 85.5, chojeo: 83, gender:'all', logo: "fas fa-chess-king", color: "text-red-700" },
            { id: 19, name: "ë‹¨êµ­ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.80, cut_n: 2.85, jeongsi_cut: 84.0, chojeo: 82, gender:'all', logo: "fas fa-bear", color: "text-blue-900" },
            { id: 20, name: "ì„œìš¸ê³¼ê¸°ëŒ€", tier: "in_seoul_mid", cut_h: 2.90, cut_n: 2.50, jeongsi_cut: 85.0, chojeo: 82, gender:'all', logo: "fas fa-microchip", color: "text-black" },
            { id: 21, name: "ì¸í•˜ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.85, cut_n: 2.80, jeongsi_cut: 82.0, chojeo: 80, gender:'all', logo: "fas fa-plane", color: "text-blue-600" },
            { id: 22, name: "ì•„ì£¼ëŒ€í•™êµ", tier: "in_seoul_mid", cut_h: 2.80, cut_n: 2.75, jeongsi_cut: 83.0, chojeo: 81, gender:'all', logo: "fas fa-user-md", color: "text-blue-900" },
            // Jigeoguk
            { id: 30, name: "ë¶€ì‚°ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 3.0, cut_n: 3.1, jeongsi_cut: 83.0, chojeo: 82, gender:'all', logo: "fas fa-mountain", color: "text-blue-700" },
            { id: 31, name: "ê²½ë¶ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 3.1, cut_n: 3.2, jeongsi_cut: 82.5, chojeo: 81, gender:'all', logo: "fas fa-apple-alt", color: "text-red-700" },
            { id: 32, name: "ì „ë‚¨ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 3.5, cut_n: 3.6, jeongsi_cut: 76.0, chojeo: 75, gender:'all', logo: "fas fa-tree", color: "text-green-700" },
            { id: 33, name: "ì¶©ë‚¨ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 3.4, cut_n: 3.5, jeongsi_cut: 77.0, chojeo: 76, gender:'all', logo: "fas fa-horse", color: "text-blue-800" },
            { id: 34, name: "ì¶©ë¶ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 3.7, cut_n: 3.9, jeongsi_cut: 74.0, chojeo: 74, gender:'all', logo: "fas fa-bullseye", color: "text-red-800" },
            { id: 35, name: "ì „ë¶ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 3.8, cut_n: 4.0, jeongsi_cut: 73.0, chojeo: 73, gender:'all', logo: "fas fa-book", color: "text-purple-700" },
            { id: 36, name: "ê°•ì›ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 4.0, cut_n: 4.3, jeongsi_cut: 70.0, chojeo: 70, gender:'all', logo: "fas fa-mountain", color: "text-green-600" },
            { id: 37, name: "ì œì£¼ëŒ€í•™êµ", tier: "jigeoguk", cut_h: 4.5, cut_n: 4.8, jeongsi_cut: 67.0, chojeo: 65, gender:'all', logo: "fas fa-island-tropical", color: "text-orange-500" },
            // Metro Low / Local
            { id: 50, name: "í•œê²½êµ­ë¦½ëŒ€", tier: "metro_low", cut_h: 3.8, cut_n: 4.2, jeongsi_cut: 72.0, chojeo: 0, gender:'all', logo: "fas fa-leaf", color: "text-green-600" },
            { id: 51, name: "ìˆ˜ì›ëŒ€í•™êµ", tier: "metro_low", cut_h: 4.0, cut_n: 4.3, jeongsi_cut: 70.0, chojeo: 0, gender:'all', logo: "fas fa-bell", color: "text-yellow-600" },
            { id: 52, name: "ê°•ë‚¨ëŒ€í•™êµ", tier: "metro_low", cut_h: 3.9, cut_n: 4.1, jeongsi_cut: 71.0, chojeo: 0, gender:'all', logo: "fas fa-building", color: "text-blue-500" },
            { id: 53, name: "ì•ˆì–‘ëŒ€í•™êµ", tier: "metro_low", cut_h: 4.2, cut_n: 4.5, jeongsi_cut: 68.0, chojeo: 0, gender:'all', logo: "fas fa-road", color: "text-indigo-600" },
            { id: 54, name: "ì„±ê²°ëŒ€í•™êµ", tier: "metro_low", cut_h: 4.3, cut_n: 4.6, jeongsi_cut: 67.0, chojeo: 0, gender:'all', logo: "fas fa-church", color: "text-purple-600" },
            { id: 55, name: "ìš©ì¸ëŒ€í•™êµ", tier: "metro_low", cut_h: 4.1, cut_n: 4.4, jeongsi_cut: 69.0, chojeo: 0, gender:'all', logo: "fas fa-dragon", color: "text-green-700" },
            { id: 57, name: "ëŒ€ì§„ëŒ€í•™êµ", tier: "metro_low", cut_h: 4.8, cut_n: 5.2, jeongsi_cut: 60.0, chojeo: 0, gender:'all', logo: "fas fa-mountain", color: "text-blue-400" },
            { id: 58, name: "í˜‘ì„±ëŒ€í•™êµ", tier: "metro_low", cut_h: 4.9, cut_n: 5.3, jeongsi_cut: 58.0, chojeo: 0, gender:'all', logo: "fas fa-hand-holding-heart", color: "text-pink-500" },
            { id: 59, name: "ë°±ì„ëŒ€í•™êµ", tier: "metro_low", cut_h: 5.0, cut_n: 5.4, jeongsi_cut: 57.0, chojeo: 0, gender:'all', logo: "fas fa-book", color: "text-blue-600" },
            { id: 60, name: "ë‚¨ì„œìš¸ëŒ€", tier: "metro_low", cut_h: 5.2, cut_n: 5.5, jeongsi_cut: 55.0, chojeo: 0, gender:'all', logo: "fas fa-star", color: "text-yellow-500" }
        ];

        const quizPool = [
            // êµ­ì–´
            { subject: "êµ­ì–´(ë¬¸ë²•)", q: "'ë§í˜•'ì˜ ì˜¬ë°”ë¥¸ ë°œìŒì€?", options: ["ë§ˆí…½", "ë§ˆí˜•", "ë§í˜•", "ë§ˆë¡"], a: 0 },
            { subject: "êµ­ì–´(ë¬¸í•™)", q: "ìœ¤ë™ì£¼ì˜ 'ì„œì‹œ'ì— ë‚˜ì˜¤ì§€ ì•ŠëŠ” ë‹¨ì–´ëŠ”?", options: ["ë³„", "ë°”ëŒ", "ììƒˆ", "ìë™ì°¨"], a: 3 },
            { subject: "êµ­ì–´(ë¬¸ë²•)", q: "ì‚¬ì´ì‹œì˜· ê·œì •ì— ë§ëŠ” í‘œê¸°ëŠ”?", options: ["ì¥ë§›ë¹„", "ì¥ë§ˆë¹„", "ì¥ë§ˆë¹—", "ë¹„ì¥ë§ˆ"], a: 0 },
            { subject: "êµ­ì–´(ê³ ì „)", q: "'ê´€ë™ë³„ê³¡'ì˜ ì‘ê°€ëŠ”?", options: ["ì •ì² ", "í™©ì§„ì´", "ì´í™©", "ì´ì´"], a: 0 },
            // ìˆ˜í•™
            { subject: "ìˆ˜í•™(ëŒ€ìˆ˜)", q: "logâ‚‚8 + logâ‚‚2 ì˜ ê°’ì€?", options: ["3", "4", "5", "6"], a: 1 },
            { subject: "ìˆ˜í•™(ë¯¸ë¶„)", q: "f(x) = xÂ³ ì˜ ë„í•¨ìˆ˜ f'(x)ëŠ”?", options: ["3xÂ²", "xÂ²", "3x", "2x"], a: 0 },
            { subject: "ìˆ˜í•™(í™•ë¥ )", q: "ì„œë¡œ ë‹¤ë¥¸ ì£¼ì‚¬ìœ„ 2ê°œë¥¼ ë˜ì ¸ í•©ì´ 12ì¼ í™•ë¥ ì€?", options: ["1/36", "1/18", "1/6", "1/12"], a: 0 },
            { subject: "ìˆ˜í•™(ì ë¶„)", q: "âˆ« 2x dx ì˜ ë¶€ì •ì ë¶„ì€? (CëŠ” ìƒìˆ˜)", options: ["xÂ²+C", "2xÂ²+C", "x+C", "xÂ³+C"], a: 0 },
            // ì˜ì–´
            { subject: "ì˜ì–´(ì–´íœ˜)", q: "'Ubiquitous'ì˜ ëœ»ì€?", options: ["ì–´ë””ì—ë‚˜ ìˆëŠ”", "í¬ê·€í•œ", "ìœ ì¼í•œ", "ì‚¬ë¼ì§„"], a: 0 },
            { subject: "ì˜ì–´(ì–´íœ˜)", q: "'Benevolent'ì˜ ë°˜ëŒ€ë§ì€?", options: ["Malevolent", "Kind", "Generous", "Good"], a: 0 },
            { subject: "ì˜ì–´(ë¬¸ë²•)", q: "I look forward to ____ you.", options: ["meeting", "meet", "met", "will meet"], a: 0 },
            // ì‚¬íšŒ
            { subject: "í•œêµ­ì‚¬", q: "ì„ì§„ì™œë€ì´ ë°œë°œí•œ ì—°ë„ëŠ”?", options: ["1392", "1592", "1894", "1910"], a: 1 },
            { subject: "ìœ¤ë¦¬", q: "ê³µë¦¬ì£¼ì˜ë¥¼ ì£¼ì¥í•œ ëŒ€í‘œì  ì‚¬ìƒê°€ëŠ”?", options: ["ë²¤ë‹´", "ì¹¸íŠ¸", "í”Œë¼í†¤", "ê³µì"], a: 0 },
            { subject: "ê²½ì œ", q: "'ë³´ì´ì§€ ì•ŠëŠ” ì†'ì„ ì£¼ì¥í•œ í•™ìëŠ”?", options: ["ì• ë¤ ìŠ¤ë¯¸ìŠ¤", "ì¼€ì¸ìŠ¤", "ë§ˆë¥´í¬ìŠ¤", "ë¦¬ì¹´ë„"], a: 0 },
            // ê³¼í•™
            { subject: "ë¬¼ë¦¬", q: "F=maëŠ” ë‰´í„´ì˜ ë¬´ìŠ¨ ë²•ì¹™ì¸ê°€?", options: ["ê°€ì†ë„ì˜ ë²•ì¹™", "ê´€ì„±ì˜ ë²•ì¹™", "ì‘ìš©ë°˜ì‘ìš©", "ë§Œìœ ì¸ë ¥"], a: 0 },
            { subject: "í™”í•™", q: "ê°€ì¥ ê°€ë²¼ìš´ ì›ì†ŒëŠ”?", options: ["ìˆ˜ì†Œ(H)", "í—¬ë¥¨(He)", "ë¦¬íŠ¬(Li)", "ì‚°ì†Œ(O)"], a: 0 },
            { subject: "ìƒëª…", q: "ì„¸í¬ì˜ ì—ë„ˆì§€ ìƒì‚° ê³µì¥ì€?", options: ["ë¯¸í† ì½˜ë“œë¦¬ì•„", "ë¦¬ë³´ì†œ", "ê³¨ì§€ì²´", "í•µ"], a: 0 },
            { subject: "ì§€êµ¬ê³¼í•™", q: "ì§€êµ¬ ìì „ì˜ ë°©í–¥ì€?", options: ["ì„œì—ì„œ ë™", "ë™ì—ì„œ ì„œ", "ë¶ì—ì„œ ë‚¨", "ë‚¨ì—ì„œ ë¶"], a: 0 },
            // í‚¬ëŸ¬
            { subject: "ìˆ˜í•™(í‚¬ëŸ¬)", q: "sin(90ë„) + cos(0ë„) ì˜ ê°’ì€?", options: ["2", "1", "0", "-1"], a: 0 },
            { subject: "ê³¼í•™(í‚¬ëŸ¬)", q: "ìƒëŒ€ì„± ì´ë¡ ì„ ë°œí‘œí•œ ê³¼í•™ìëŠ”?", options: ["ì•„ì¸ìŠˆíƒ€ì¸", "ë‰´í„´", "ë³´ì–´", "í•˜ì´ì  ë² ë¥´í¬"], a: 0 },
            { subject: "ìƒì‹(í‚¬ëŸ¬)", q: "GDPì˜ ëœ»ì€?", options: ["êµ­ë‚´ì´ìƒì‚°", "êµ­ë¯¼ì´ì†Œë“", "ë¬¼ê°€ìƒìŠ¹ë¥ ", "ê²½ì œì„±ì¥ë¥ "], a: 0 },
            { subject: "ì—­ì‚¬(í‚¬ëŸ¬)", q: "ê³ ë ¤ë¥¼ ê±´êµ­í•œ ì™•ì€?", options: ["ì™•ê±´", "ì´ì„±ê³„", "ê¶ì˜ˆ", "ê²¬í›¤"], a: 0 },
            { subject: "ë¬¸í•™(í‚¬ëŸ¬)", q: "ì´ìœ¡ì‚¬ì˜ ì‹œ 'ê´‘ì•¼'ì˜ ì£¼ì œëŠ”?", options: ["ì¡°êµ­ ê´‘ë³µ ì˜ì§€", "ìì—° ì¹œí™”", "ì´ë³„ì˜ ìŠ¬í””", "ì¸ìƒë¬´ìƒ"], a: 0 }
        ];

        // --- Major Keyword Logic ---
        function getMajorSpecificQuestion(major) {
            if (!major) return { q: "ì „ê³µê³¼ ê´€ë ¨í•˜ì—¬ ë³¸ì¸ì´ ë…¸ë ¥í•œ ì ì„ ë§í•´ë³´ì„¸ìš”.", options: ["ì±…ì„ ë§ì´ ì½ì—ˆìŠµë‹ˆë‹¤.", "ë™ì•„ë¦¬ í™œë™ì„ í–ˆìŠµë‹ˆë‹¤.", "ì„±ì  ê´€ë¦¬ë¥¼ í–ˆìŠµë‹ˆë‹¤.", "ë”±íˆ ì—†ìŠµë‹ˆë‹¤."], a: 1 };
            
            const m = major.toLowerCase();
            if (m.includes("ì»´í“¨í„°") || m.includes("ì†Œí”„íŠ¸ì›¨ì–´") || m.includes("ai")) {
                return { q: "AI ìœ¤ë¦¬ ë¬¸ì œì— ëŒ€í•´ ì–´ë–»ê²Œ ìƒê°í•˜ì‹œë‚˜ìš”?", options: ["ê°œë°œì„ ë©ˆì¶°ì•¼ í•©ë‹ˆë‹¤.", "ê·œì œì™€ ë°œì „ì´ ë³‘í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.", "ë¬´ì¡°ê±´ ë°œì „ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.", "ì˜ ëª¨ë¥´ê² ìŠµë‹ˆë‹¤."], a: 1 };
            } else if (m.includes("ê²½ì˜") || m.includes("ê²½ì œ")) {
                return { q: "ìµœê·¼ ESG ê²½ì˜ì´ í™”ë‘ì¸ë°, ê°€ì¥ ì¤‘ìš”í•œ ìš”ì†ŒëŠ”?", options: ["í™˜ê²½(E)", "ì‚¬íšŒ(S)", "ì§€ë°°êµ¬ì¡°(G)", "ì´ìœ¤ ì°½ì¶œ"], a: 0 };
            } else if (m.includes("ê°„í˜¸") || m.includes("ì˜í•™") || m.includes("ë³´ê±´")) {
                return { q: "í™˜ìì˜ ìê¸°ê²°ì •ê¶Œê³¼ ì˜ì‚¬ì˜ íŒë‹¨ì´ ì¶©ëŒí•  ë•Œ?", options: ["ì˜ì‚¬ì˜ íŒë‹¨ì„ ë”°ë¥¸ë‹¤.", "í™˜ìë¥¼ ì„¤ë“í•˜ë˜ ê²°ì •ì„ ì¡´ì¤‘í•œë‹¤.", "ê°€ì¡±ì—ê²Œ ë¬»ëŠ”ë‹¤.", "ë²•ëŒ€ë¡œ í•œë‹¤."], a: 1 };
            } else if (m.includes("ë””ìì¸") || m.includes("ì˜ˆìˆ ") || m.includes("ë¯¸ìˆ ")) {
                return { q: "ì¢‹ì€ ë””ìì¸ì´ë€ ë¬´ì—‡ì´ë¼ê³  ìƒê°í•©ë‹ˆê¹Œ?", options: ["ì˜ˆìœ ê²ƒ", "ê¸°ëŠ¥ì ì¸ ê²ƒ", "ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê²ƒ", "ë¹„ì‹¼ ê²ƒ"], a: 2 };
            } else if (m.includes("ì²´ìœ¡") || m.includes("ìŠ¤í¬ì¸ ")) {
                return { q: "ìŠ¤í¬ì¸ ë§¨ì‹­ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê°€ì¹˜ëŠ”?", options: ["ìŠ¹ë¦¬", "ê³µì •ì„±", "ì¸ê¸°", "ì—°ë´‰"], a: 1 };
            } else {
                return { q: `[${major}] ì „ê³µì„ ì„ íƒí•œ êµ¬ì²´ì ì¸ ì´ìœ ëŠ”?`, options: ["ì„±ì  ë§ì¶°ì„œ", "ì·¨ì—… ì˜ ë  ê²ƒ ê°™ì•„ì„œ", "ê´€ë ¨ ì„œì ì„ ì½ê³  í¥ë¯¸ë¥¼ ëŠê»´ì„œ", "ë¶€ëª¨ë‹˜ ê¶Œìœ "], a: 2 };
            }
        }

        const nonsulQuestions = [
            { type: "ìˆ˜ë¦¬", q: "[ì‹¬í™”] ë¯¸ë¶„ê°€ëŠ¥í•œ í•¨ìˆ˜ f(x)ê°€ f'(x)=f(x)ë¥¼ ë§Œì¡±í•  ë•Œ f(x)ì˜ ê¼´ì€?", options: ["Ce^x", "Cx^2", "Clnx", "sin(x)"], a: 0 },
            { type: "ì¸ë¬¸", q: "[ì‹¬í™”] 'ì£„ìˆ˜ì˜ ë”œë ˆë§ˆ'ì—ì„œ ë‘ ì£„ìˆ˜ê°€ ëª¨ë‘ ìë°±í•˜ëŠ” í˜„ìƒì€?", options: ["íŒŒë ˆí†  ìµœì ", "ë‚´ì‰¬ ê· í˜•", "ê³µë¦¬ì£¼ì˜", "ê¸°íšŒë¹„ìš©"], a: 1 },
            { type: "ì‚¬íšŒ", q: "[ì‹¬í™”] ë¡¤ìŠ¤ì˜ ì •ì˜ë¡ ì—ì„œ 'ë¬´ì§€ì˜ ë² ì¼'ì´ ë³´ì¥í•˜ëŠ” ê²ƒì€?", options: ["ì ˆì°¨ì  ê³µì •ì„±", "ê²°ê³¼ì˜ í‰ë“±", "ìµœëŒ€ ë‹¤ìˆ˜ì˜ í–‰ë³µ", "ììœ ì§€ìƒì£¼ì˜"], a: 0 }
        ];

        // Game State
        let player = { name: "", school: "", gender: "M", track: "ì¸ë¬¸", major: "", gpa: 0, sat: 0 };
        let currentQuizQueue = [];
        let currentRound = 0;
        let maxRounds = 5;
        let consecutiveCorrect = 0;
        let susiCart = [];
        let jeongsiCart = [];
        let finalResults = []; 
        let passedUniversities = []; 
        let selectedUniForModal = null;
        let jonghapScore = 0;
        let nonsulScore = 0;
        let practicalScore = 0; 
        let reactionTimer, reactionStartTime, reactionState = 'waiting';

        // Interview Stages
        let interviewStage = 0; // 0: Basic, 1: Applied, 2: Major
        
        // --- Functions ---
        function updateStatus() {
            const nameEl = document.getElementById('display-name');
            if(nameEl) nameEl.innerText = player.name;
            const majorEl = document.getElementById('display-major');
            if(majorEl) majorEl.innerText = player.major || "ë¯¸ì •";
            const gpaEl = document.getElementById('display-gpa');
            if(gpaEl) gpaEl.innerText = player.gpa.toFixed(2);
            const satEl = document.getElementById('display-sat');
            if(satEl) satEl.innerText = player.sat;
            
            const susiBadge = document.getElementById('susi-badge');
            if(susiBadge) susiBadge.innerText = susiCart.length;
            const jeongsiBadge = document.getElementById('jeongsi-badge');
            if(jeongsiBadge) jeongsiBadge.innerText = jeongsiCart.length;

            const badge = document.getElementById('combo-badge');
            if(badge) {
                 if(consecutiveCorrect > 1) {
                    badge.classList.remove('hidden');
                    badge.innerText = `ğŸ”¥ ${consecutiveCorrect} COMBO!`;
                } else {
                    badge.classList.add('hidden');
                }
            }
        }

        function switchScene(id) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden-section'));
            const target = document.getElementById(id);
            if(target) {
                target.classList.remove('hidden-section');
                target.classList.add('slide-in');
                window.scrollTo(0,0);
            }
        }

        // 1. Intro Logic
        window.onload = function() {
            const retryMode = localStorage.getItem('retryMode');
            const alertBox = document.getElementById('penalty-alert');
            
            if(retryMode === 'jaesu') {
                if(alertBox) {
                    alertBox.classList.remove('hidden');
                    alertBox.innerHTML = 'âš ï¸ <b>ì¬ìˆ˜ìƒ ëª¨ë“œ:</b> ë‚´ì‹  -0.5 í˜ë„í‹° ì ìš©ë¨';
                }
                activeRetryMode = 'jaesu';
                localStorage.removeItem('retryMode');
            } else if(retryMode === 'gunsu') {
                if(alertBox) {
                    alertBox.classList.remove('hidden');
                    alertBox.innerHTML = 'ğŸª– <b>êµ°ìˆ˜ìƒ ëª¨ë“œ:</b> ë‚´ì‹  -0.7 í˜ë„í‹° / í€´ì¦ˆ 10íšŒ';
                }
                activeRetryMode = 'gunsu';
                
                const body = document.getElementById('main-body');
                if(body) { body.classList.remove('bg-cute-pattern'); body.classList.add('bg-army'); }
                const header = document.getElementById('main-header');
                if(header) { header.classList.remove('bg-white/90','text-pink-600'); header.classList.add('bg-slate-900/90','text-green-400'); }
                
                maxRounds = 10;
                localStorage.removeItem('retryMode');
            }
        };

        const profileForm = document.getElementById('profile-form');
        if(profileForm) {
            profileForm.addEventListener('submit', (e) => {
                e.preventDefault();
                player.name = document.getElementById('input-name').value;
                player.school = document.getElementById('input-school').value;
                player.major = document.getElementById('input-major').value;
                player.gender = document.getElementById('input-gender').value;
                player.track = document.getElementById('input-track').value;
                player.gpa = parseFloat(document.getElementById('input-gpa').value);
                player.sat = parseInt(document.getElementById('input-sat').value);

                // PENALTY APPLICATION FIX
                if(activeRetryMode === 'jaesu') {
                    player.gpa = Math.min(9.0, player.gpa + 0.5);
                    console.log("Jaesu Penalty Applied");
                } else if(activeRetryMode === 'gunsu') {
                    player.gpa = Math.min(9.0, player.gpa + 0.7);
                    maxRounds = 10;
                    console.log("Gunsu Penalty Applied");
                }

                document.getElementById('status-bar').classList.remove('hidden');
                document.getElementById('status-bar').classList.add('flex');
                updateStatus();
                document.getElementById('total-rounds').innerText = maxRounds;
                switchScene('scene-quiz');
                loadQuiz();
            });
        }

        // 2. Quiz Logic
        function loadQuiz() {
            if(currentQuizQueue.length === 0) currentQuizQueue = [...quizPool].sort(()=>0.5-Math.random()).slice(0, maxRounds);
            if(currentRound >= maxRounds) { setTimeout(startSusi, 500); return; }
            
            document.getElementById('current-round').innerText = currentRound+1;
            document.getElementById('quiz-feedback').classList.add('hidden');
            
            const q = currentQuizQueue[currentRound];
            document.getElementById('quiz-subject').innerText = q.subject;
            document.getElementById('quiz-question').innerText = q.q;
            const opts = document.getElementById('quiz-options');
            opts.innerHTML = '';
            q.options.forEach((o, i) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded-xl border-2 border-slate-100 hover:border-indigo-500 hover:bg-indigo-50 font-bold text-slate-600 transition active:scale-95";
                btn.innerHTML = `<span class="bg-indigo-100 text-indigo-700 px-2 py-1 rounded mr-2 text-xs">${i+1}</span> ${o}`;
                btn.onclick = () => checkAnswer(i, q.a);
                opts.appendChild(btn);
            });
        }
        function checkAnswer(sel, ans) {
            const fb = document.getElementById('quiz-feedback');
            const icon = document.getElementById('feedback-icon');
            const text = document.getElementById('feedback-text');
            const detail = document.getElementById('feedback-detail');
            
            if(fb) fb.classList.remove('hidden');
            const opts = document.getElementById('quiz-options');
            if(opts) opts.querySelectorAll('button').forEach(b=>b.disabled=true);
            
            if(sel===ans) {
                consecutiveCorrect++;
                const gpaBonus = 0.1 + (consecutiveCorrect-1)*0.05;
                const satBonus = 3 + (consecutiveCorrect-1)*2;
                player.gpa = Math.max(1.0, player.gpa - gpaBonus);
                player.sat = Math.min(100, player.sat + satBonus);
                if(icon) icon.innerHTML = "ğŸ‰";
                if(text) text.innerHTML = "ì •ë‹µì…ë‹ˆë‹¤!";
                if(detail) detail.innerHTML = `<span class="score-change score-up">ë‚´ì‹  -${gpaBonus.toFixed(2)} â–¼</span> <span class="score-change score-up">ìˆ˜ëŠ¥ +${satBonus} â–²</span>`;
            } else {
                consecutiveCorrect = 0;
                player.gpa = Math.min(9.0, player.gpa + 0.1);
                player.sat = Math.max(0, player.sat - 2);
                if(icon) icon.innerHTML = "ğŸ˜­";
                if(text) text.innerHTML = "ì˜¤ë‹µì…ë‹ˆë‹¤...";
                if(detail) detail.innerHTML = `<span class="score-change score-down">ë‚´ì‹  +0.1 â–²</span> <span class="score-change score-down">ìˆ˜ëŠ¥ -2 â–¼</span>`;
            }
            updateStatus();
        }
        document.getElementById('next-quiz-btn').onclick = () => { currentRound++; loadQuiz(); };

        // 3. Susi Logic
        function startSusi() {
            switchScene('scene-susi');
            updateStatus(); 
            renderSusiList('all');
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.onclick = (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('bg-slate-800','text-white'));
                    e.target.classList.add('bg-slate-800','text-white');
                    renderSusiList(e.target.dataset.filter);
                };
            });
        }
        
        function renderSusiList(filter) {
            const list = document.getElementById('susi-uni-list');
            if(!list) return;
            list.innerHTML = '';
            universities.forEach(u => {
                if(player.gender === 'M' && u.gender === 'F') return;
                if(filter !== 'all') {
                    if(filter === 'metro_low' && u.tier !== 'metro_low') return;
                    if(filter !== 'metro_low' && u.tier !== filter) return;
                }

                let targetCut = u.cut_h; 
                if(player.track === 'ìì—°') targetCut = u.cut_n;
                if(player.track === 'ì˜ˆì²´ëŠ¥') targetCut = u.cut_h + 1.0; 

                const diff = player.gpa - targetCut;
                let badge = diff <= -0.3 ? "ì•ˆì •" : (diff <= 0.2 ? "ì ì •" : "ìƒí–¥");
                let badgeColor = diff <= -0.3 ? "bg-green-100 text-green-700" : (diff <= 0.2 ? "bg-blue-100 text-blue-700" : "bg-red-100 text-red-700");

                let recommendTag = "";
                if(diff <= 0.1) recommendTag = '<span class="ai-recommend ml-2">ğŸ‘ AIì¶”ì²œ</span>';

                const d = document.createElement('div');
                d.className = "university-card bg-white border border-slate-100 p-4 rounded-2xl flex justify-between items-center cursor-pointer transition-all";
                d.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center text-xl ${u.color} shadow-sm border border-slate-100"><i class="${u.logo}"></i></div>
                        <div>
                            <div class="font-bold text-slate-800 font-game">${u.name} ${recommendTag}</div>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-[10px] ${badgeColor} px-2 py-0.5 rounded-full font-bold">${badge}</span>
                                <span class="text-xs text-slate-400">ì»· ${targetCut}</span>
                            </div>
                        </div>
                    </div>
                    <button class="add-btn w-9 h-9 rounded-full bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white flex items-center justify-center transition"><i class="fas fa-plus"></i></button>
                `;
                d.querySelector('.add-btn').onclick = () => openTypeModal(u);
                list.appendChild(d);
            });
        }

        // Modal & Cart
        function openTypeModal(u) {
            if(susiCart.length >= 6) { alert("ìˆ˜ì‹œ ì›ì„œëŠ” ìµœëŒ€ 6ì¥ì…ë‹ˆë‹¤."); return; }
            selectedUniForModal = u;
            document.getElementById('modal-uni-name').innerText = u.name;
            const chojeoText = u.chojeo > 0 ? `ìˆ˜ëŠ¥ìµœì €: ë°±ë¶„ìœ„ ${u.chojeo}` : "ìˆ˜ëŠ¥ìµœì € ì—†ìŒ";
            document.getElementById('modal-uni-chojeo').innerText = chojeoText;
            document.getElementById('type-modal').classList.remove('hidden');
        }
        function closeModal() { document.getElementById('type-modal').classList.add('hidden'); selectedUniForModal=null; }
        
        document.querySelectorAll('.type-select-btn').forEach(b => {
            b.onclick = () => { 
                if(selectedUniForModal) { 
                    const type = b.dataset.type;
                    if(susiCart.find(x => x.id === selectedUniForModal.id && x.type === type)) {
                        alert("ì´ë¯¸ í•´ë‹¹ ëŒ€í•™ì˜ ë™ì¼ ì „í˜•ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.");
                        return;
                    }
                    susiCart.push({...selectedUniForModal, type: type}); 
                    updateSusiCart(); 
                    closeModal(); 
                } 
            };
        });

        function updateSusiCart() {
            const list = document.getElementById('susi-cart');
            const cnt = document.getElementById('susi-count');
            const btn = document.getElementById('btn-susi-submit');
            
            if(cnt) cnt.innerText = susiCart.length;
            if(list) {
                list.innerHTML = '';
                susiCart.forEach((u, i) => {
                    const li = document.createElement('li');
                    li.className = "flex justify-between items-center p-3 bg-white border border-slate-100 rounded-xl text-sm pop-in shadow-sm";
                    li.innerHTML = `<div><span class="font-bold text-xs bg-gray-100 px-1 rounded mr-1">${u.type}</span> ${u.name}</div><button onclick="removeSusiItem(${i})"><i class="fas fa-times text-red-300"></i></button>`;
                    list.appendChild(li);
                });
            }
            updateStatus();

            if(btn) {
                if(susiCart.length > 0) {
                    btn.disabled = false;
                    btn.className = "w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg transition-all active:scale-95 font-game text-xl";
                    btn.innerText = `ìˆ˜ì‹œ ${susiCart.length}ì¥ ì ‘ìˆ˜í•˜ê¸°`;
                } else {
                    btn.disabled = true;
                    btn.className = "w-full bg-slate-200 text-slate-400 font-bold py-4 rounded-2xl transition-all cursor-not-allowed font-game text-xl";
                    btn.innerText = "ëŒ€í•™ì„ ì„ íƒí•˜ì„¸ìš”";
                }
            }
        }
        
        window.removeSusiItem = function(index) {
            susiCart.splice(index, 1);
            updateSusiCart();
        }

        const susiSubmit = document.getElementById('btn-susi-submit');
        if(susiSubmit) {
            susiSubmit.onclick = () => {
                const needsExam = susiCart.some(u => u.type === 'ì¢…í•©' || u.type === 'ë…¼ìˆ ') || player.track === 'ì˜ˆì²´ëŠ¥';
                if(needsExam) switchScene('scene-exam-intro');
                else processSusiResults();
            };
        }

        window.startActualExams = function() {
            if(player.track === 'ì˜ˆì²´ëŠ¥') setupPractical(); 
            else if(susiCart.some(u=>u.type==='ì¢…í•©')) setupInterviewStage(0); 
            else if(susiCart.some(u=>u.type==='ë…¼ìˆ ')) setupEssay();
            else processSusiResults();
        }

        // --- UPGRADED Interview Logic (3 Stages) ---
        function setupInterviewStage(stage) {
            interviewStage = stage;
            switchScene('scene-interview');
            const container = document.getElementById('interview-content');
            
            const steps = [1,2,3].map(n => `<div class="w-3 h-3 rounded-full ${n<=stage+1 ? 'bg-green-500':'bg-slate-300'}"></div>`).join('');
            document.querySelector('#scene-interview .flex.justify-center').innerHTML = steps;

            let q;
            let typeLabel = "";
            
            if(stage === 0) { // Basic
                typeLabel = "ê¸°ë³¸ ì¸ì„±";
                q = { q: "ìš°ë¦¬ ëŒ€í•™ì— ì§€ì›í•˜ê²Œ ëœ ê°€ì¥ í° ë™ê¸°ëŠ” ë¬´ì—‡ì¸ê°€ìš”?", options: ["ì ìˆ˜ ë§ì¶°ì„œ ì™”ìŠµë‹ˆë‹¤.", "ë¶€ëª¨ë‹˜ì´ ì‹œì¼°ìŠµë‹ˆë‹¤.", "ê·€êµì˜ ì»¤ë¦¬í˜ëŸ¼ì´ ì œ ê¿ˆê³¼ ì¼ì¹˜í•©ë‹ˆë‹¤.", "ì·¨ì—…ì´ ì˜ ë  ê²ƒ ê°™ì•„ì„œì…ë‹ˆë‹¤."], a: 2 };
            } else if (stage === 1) { // Applied
                typeLabel = "ìƒí™© ëŒ€ì²˜";
                q = { q: "íŒ€ í”„ë¡œì íŠ¸ ì¤‘ ë¬´ì„ìŠ¹ì°¨í•˜ëŠ” ë™ë£Œê°€ ìˆë‹¤ë©´?", options: ["ì´ë¦„ì„ ëºë‹ˆë‹¤.", "êµìˆ˜ë‹˜ê»˜ ì´ë¦…ë‹ˆë‹¤.", "ëŒ€í™”ë¡œ ì°¸ì—¬ë¥¼ ìœ ë„í•˜ê³  ì—­í• ì„ ë¶„ë‹´í•©ë‹ˆë‹¤.", "ì œê°€ ë‹¤ í•©ë‹ˆë‹¤."], a: 2 };
            } else { // Major Specific (AI Generated Feel)
                typeLabel = "ì „ê³µ ì í•©ì„±";
                const majorQ = getMajorSpecificQuestion(player.major);
                q = majorQ;
            }

            if(container) {
                container.innerHTML = `
                    <div class="mb-6"><span class="bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold mb-2 inline-block">${typeLabel}</span><p class="font-bold text-xl text-slate-800 leading-relaxed">"${q.q}"</p></div>
                    <div class="grid gap-3">${q.options.map((o,i)=>`<button onclick="handleInterviewAnswer(${i}, ${q.a})" class="w-full text-left p-4 bg-white border-2 border-green-100 rounded-xl hover:bg-green-50 transition font-medium">${i+1}. ${o}</button>`).join('')}</div>
                `;
            }
        }

        window.handleInterviewAnswer = function(selected, answer) {
            if(selected === answer) jonghapScore += 0.3;
            else jonghapScore -= 0.1;

            if(interviewStage < 2) {
                setupInterviewStage(interviewStage + 1);
            } else {
                if(susiCart.some(u=>u.type==='ë…¼ìˆ ')) setupEssay();
                else processSusiResults();
            }
        }

        // Essay
        function setupEssay() {
            switchScene('scene-essay');
            const q = nonsulQuestions[Math.floor(Math.random()*nonsulQuestions.length)];
            const container = document.getElementById('essay-content');
            if(container) {
                container.innerHTML = `
                    <div class="mb-6"><span class="bg-purple-100 text-purple-700 px-2 py-1 rounded text-xs font-bold mb-2 inline-block">${q.type}</span><p class="font-bold text-xl text-slate-800 leading-relaxed">${q.q}</p></div>
                    <div class="grid gap-3">${q.options.map((o,i)=>`<button onclick="nonsulScore=${i===q.a?1.0:-0.5};processSusiResults()" class="w-full text-left p-4 bg-white border-2 border-purple-100 rounded-xl hover:bg-purple-50 transition font-medium">${i+1}. ${o}</button>`).join('')}</div>
                `;
            }
        }
        
        // Practical
        function setupPractical() {
            switchScene('scene-practical');
            startReactionTest();
        }
        function startReactionTest() {
            const box = document.getElementById('reaction-area');
            const res = document.getElementById('reaction-result');
            if(box) {
                box.className = 'reaction-box reaction-waiting h-64 rounded-3xl flex items-center justify-center text-white text-3xl font-black font-game shadow-inner';
                box.innerText = "ë¹¨ê°„ìƒ‰ì¼ ë•Œ í´ë¦­í•˜ë©´ ì‹¤ê²©!";
            }
            if(res) res.innerText = "";
            reactionState = 'waiting';
            const delay = 2000 + Math.random() * 3000;
            reactionTimer = setTimeout(() => {
                reactionState = 'ready';
                if(box) {
                    box.className = 'reaction-box reaction-ready h-64 rounded-3xl flex items-center justify-center text-white text-3xl font-black font-game shadow-inner';
                    box.innerText = "ì§€ê¸ˆ í´ë¦­í•˜ì„¸ìš”!!!";
                }
                reactionStartTime = Date.now();
            }, delay);
        }
        window.handleReactionClick = function() {
            if(reactionState === 'waiting') {
                clearTimeout(reactionTimer);
                alert("ë„ˆë¬´ ë¹¨ëìŠµë‹ˆë‹¤! ê°ì ë©ë‹ˆë‹¤.");
                practicalScore = -0.5;
                showPracticalNext();
            } else if (reactionState === 'ready') {
                const time = Date.now() - reactionStartTime;
                const area = document.getElementById('reaction-area');
                if(area) area.innerText = `${time}ms ì„±ê³µ!`;
                if(time < 300) practicalScore = 1.0;
                else if(time < 500) practicalScore = 0.5;
                else practicalScore = 0;
                showPracticalNext();
            }
        }
        function showPracticalNext() {
            const btn = document.getElementById('practical-next-btn');
            if(btn) {
                btn.classList.remove('hidden');
                btn.onclick = () => {
                    if(susiCart.some(u=>u.type==='ì¢…í•©')) setupInterviewStage(0);
                    else if(susiCart.some(u=>u.type==='ë…¼ìˆ ')) setupEssay();
                    else processSusiResults();
                };
            }
        }

        // Susi Processing
        function processSusiResults() {
            switchScene('scene-susi-result');
            const list = document.getElementById('susi-result-list');
            if(list) list.innerHTML = '';
            passedUniversities = [];
            
            susiCart.forEach((u, i) => {
                setTimeout(() => {
                    let passed = false;
                    let baseCut = (player.track === 'ìì—°') ? u.cut_n : u.cut_h;
                    if(player.track === 'ì˜ˆì²´ëŠ¥') baseCut += 1.0; 

                    if (u.type === 'êµê³¼') {
                        if (player.sat < u.chojeo) passed = false; 
                        else {
                            if (player.gpa <= baseCut + 0.1) passed = true; 
                            else passed = Math.random() < 0.2; 
                        }
                    } else {
                        let finalScore = baseCut;
                        if(u.type==='ì¢…í•©') finalScore += (0.3 + jonghapScore);
                        if(u.type==='ë…¼ìˆ ') finalScore += (1.0 + nonsulScore);
                        if(player.track === 'ì˜ˆì²´ëŠ¥') finalScore += practicalScore;
                        const diff = finalScore - player.gpa;
                        let prob = (diff>0.5)?95:(diff>0)?70:(diff>-0.3)?30:5;
                        passed = Math.random()*100 < prob;
                    }

                    if(passed) {
                        passedUniversities.push({...u, method: 'ìˆ˜ì‹œ'});
                        playSuccessSound();
                    } else {
                        playFailSound();
                    }

                    const d = document.createElement('div');
                    d.className = "bg-white border rounded-2xl p-6 shadow-sm flex flex-col items-center justify-center pop-in";
                    d.innerHTML = `
                        <div class="text-xs text-slate-400 font-bold mb-1">${u.type}</div>
                        <div class="font-bold text-lg mb-2 font-game">${u.name}</div>
                        <div class="text-xl font-black ${passed?'text-green-600':'text-slate-300'} font-game">${passed?'í•©ê²©':'ë¶ˆí•©ê²©'}</div>
                        ${(u.type==='êµê³¼' && player.sat < u.chojeo) ? '<div class="text-xs text-red-400 mt-1 font-bold">ìµœì € ë¯¸ë‹¬</div>' : ''}
                    `;
                    if(list) list.appendChild(d);

                    if(i === susiCart.length-1) {
                        document.getElementById('susi-outcome-controls').classList.remove('hidden');
                        if(passedUniversities.length > 0) document.getElementById('susi-pass-msg').classList.remove('hidden');
                        else document.getElementById('susi-fail-msg').classList.remove('hidden');
                    }
                }, i*800);
            });
        }

        const susiFinalBtn = document.getElementById('go-to-final-choice-susi');
        if(susiFinalBtn) susiFinalBtn.onclick = () => showFinalSelection(passedUniversities);
        
        const jeongsiBtn = document.getElementById('go-to-jeongsi');
        if(jeongsiBtn) jeongsiBtn.onclick = startJeongsi;

        // Jeongsi Logic
        function startJeongsi() {
            switchScene('scene-jeongsi');
            renderJeongsiList('all');
            document.querySelectorAll('.j-filter-btn').forEach(btn => {
                btn.onclick = (e) => {
                    document.querySelectorAll('.j-filter-btn').forEach(b => b.classList.remove('bg-indigo-600','text-white'));
                    e.target.classList.add('bg-indigo-600','text-white');
                    renderJeongsiList(e.target.dataset.filter);
                };
            });
        }

        function renderJeongsiList(filter) {
            const list = document.getElementById('jeongsi-uni-list');
            if(!list) return;
            list.innerHTML = '';
            universities.forEach(u => {
                if(player.gender === 'M' && u.gender === 'F') return;
                if(filter !== 'all') {
                    if(filter === 'metro_low' && u.tier !== 'metro_low') return;
                    if(filter !== 'metro_low' && u.tier !== filter) return;
                }

                const diff = player.sat - u.jeongsi_cut;
                let badge = diff >= 5 ? "ì•ˆì •" : (diff >= 0 ? "ì ì •" : "ìƒí–¥");
                let badgeColor = diff >= 5 ? "bg-green-100 text-green-700" : (diff >= 0 ? "bg-blue-100 text-blue-700" : "bg-red-100 text-red-700");

                let recommendTag = "";
                if(diff >= 0) recommendTag = '<span class="ai-recommend ml-2">ğŸ‘ AIì¶”ì²œ</span>';

                const d = document.createElement('div');
                d.className = "university-card bg-white border border-slate-100 p-4 rounded-2xl flex justify-between items-center cursor-pointer transition-all";
                d.innerHTML = `
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-slate-50 rounded-full flex items-center justify-center text-xl ${u.color} shadow-sm border border-slate-100"><i class="${u.logo}"></i></div>
                        <div>
                            <div class="font-bold text-slate-800 font-game">${u.name} ${recommendTag}</div>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-[10px] ${badgeColor} px-2 py-0.5 rounded-full font-bold">${badge}</span>
                                <span class="text-xs text-slate-400">ì»· ${u.jeongsi_cut}%</span>
                            </div>
                        </div>
                    </div>
                    <button onclick="addToJeongsiCart(${u.id})" class="w-9 h-9 rounded-full bg-indigo-50 text-indigo-600 hover:bg-indigo-600 hover:text-white flex items-center justify-center transition"><i class="fas fa-plus"></i></button>
                `;
                list.appendChild(d);
            });
        }

        window.addToJeongsiCart = (id) => {
            if(jeongsiCart.length >= 3) { alert("ì •ì‹œëŠ” 3ì¥ì…ë‹ˆë‹¤."); return; }
            if(jeongsiCart.find(x=>x.id===id)) { alert("ì´ë¯¸ ì„ íƒí–ˆìŠµë‹ˆë‹¤."); return; }
            jeongsiCart.push(universities.find(u=>u.id===id));
            updateJeongsiCart();
        }

        function updateJeongsiCart() {
            const list = document.getElementById('jeongsi-cart');
            const cnt = document.getElementById('jeongsi-count');
            const btn = document.getElementById('submit-jeongsi');
            
            if(cnt) cnt.innerText = jeongsiCart.length;
            if(list) {
                list.innerHTML = '';
                jeongsiCart.forEach((u, i) => {
                    const li = document.createElement('li');
                    li.className = "flex justify-between items-center p-3 bg-white border border-slate-100 rounded-xl text-sm pop-in shadow-sm";
                    li.innerHTML = `<span>${u.name}</span> <button onclick="removeJeongsiItem(${i})"><i class="fas fa-times text-red-300"></i></button>`;
                    list.appendChild(li);
                });
            }
            updateStatus();

            if(btn) {
                if(jeongsiCart.length > 0) {
                    btn.disabled = false;
                    btn.className = "w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg active:scale-95 transition-all font-game text-xl";
                } else {
                    btn.disabled = true;
                    btn.className = "w-full bg-slate-200 text-slate-400 font-bold py-4 rounded-2xl cursor-not-allowed font-game text-xl";
                }
            }
        }
        
        window.removeJeongsiItem = function(index) {
            jeongsiCart.splice(index, 1);
            updateJeongsiCart();
        }

        const jeongsiSubmit = document.getElementById('submit-jeongsi');
        if(jeongsiSubmit) {
            jeongsiSubmit.onclick = () => {
                jeongsiCart.forEach(u => {
                    const diff = player.sat - u.jeongsi_cut;
                    let prob = 50 + diff*5;
                    if(prob>95) prob=95; if(prob<5) prob=5;
                    const passed = Math.random()*100 < prob;
                    if(passed) passedUniversities.push({...u, method: 'ì •ì‹œ'});
                    finalResults.push({name:u.name, status:passed?'í•©ê²©':'ë¶ˆí•©ê²©'});
                });

                switchScene('scene-jeongsi-announce');
                const container = document.getElementById('jeongsi-results-container');
                if(container) container.innerHTML = '';
                
                setTimeout(() => {
                    const loader = document.getElementById('jeongsi-loading');
                    if(loader) loader.classList.add('hidden');
                    if(container) container.classList.remove('opacity-0');
                    
                    finalResults.filter(r=>!r.type).forEach((r, i) => { 
                        setTimeout(() => {
                            if(r.status==='í•©ê²©') playSuccessSound(); else playFailSound();
                            const d = document.createElement('div');
                            d.className = "bg-white border border-slate-100 p-5 rounded-2xl shadow-sm flex justify-between items-center pop-in";
                            d.innerHTML = `<span class="font-bold text-lg text-slate-800 font-game">${r.name}</span><span class="font-black text-xl ${r.status==='í•©ê²©'?'text-green-600':'text-slate-300'} font-game">${r.status}</span>`;
                            if(container) container.appendChild(d);
                        }, i * 800);
                    });

                    setTimeout(() => {
                        const nextControls = document.getElementById('jeongsi-next-controls');
                        if(nextControls) nextControls.classList.remove('hidden');
                        
                        if(passedUniversities.length > 0) {
                            const finalChoiceBtn = document.getElementById('go-to-final-choice-jeongsi');
                            if(finalChoiceBtn) finalChoiceBtn.classList.remove('hidden');
                        } else {
                            const failOptions = document.getElementById('jeongsi-fail-options');
                            if(failOptions) failOptions.classList.remove('hidden');
                        }
                    }, jeongsiCart.length * 800 + 500);
                }, 1500);
            };
        }

        const jeongsiFinalBtn = document.getElementById('go-to-final-choice-jeongsi');
        if(jeongsiFinalBtn) jeongsiFinalBtn.onclick = () => showFinalSelection(passedUniversities);

        function showFinalSelection(passedList) {
            switchScene('scene-final-select');
            const container = document.getElementById('final-candidate-list');
            if(container) {
                container.innerHTML = '';
                passedList.forEach(u => {
                    const btn = document.createElement('button');
                    btn.className = "w-full bg-white border-2 border-blue-100 hover:border-blue-500 hover:bg-blue-50 p-6 rounded-2xl transition flex justify-between items-center group shadow-sm";
                    btn.innerHTML = `
                        <div class="flex items-center gap-4">
                            <i class="${u.logo} text-3xl ${u.color}"></i>
                            <div class="text-left">
                                <div class="font-bold text-xl text-slate-800 font-game">${u.name}</div>
                                <div class="text-sm text-slate-500 font-cute font-bold text-lg">${u.method} í•©ê²©</div>
                            </div>
                        </div>
                        <span class="text-blue-500 font-bold group-hover:underline font-game text-lg">ì„ íƒí•˜ê¸° âœ¨</span>
                    `;
                    btn.onclick = () => showFinalReport(u);
                    container.appendChild(btn);
                });
            }
        }

        function showFinalReport(university) {
            switchScene('scene-final');
            document.querySelector('.final-name').innerText = player.name;
            document.querySelector('.final-school-display').innerText = player.school;
            document.querySelectorAll('.final-gpa-display').forEach(e=>e.innerText=player.gpa.toFixed(2));
            document.querySelectorAll('.final-sat-display').forEach(e=>e.innerText=player.sat);
            
            const display = document.getElementById('final-university-display');
            if(display) {
                display.innerHTML = `
                    <div class="flex flex-col items-center">
                        <i class="${university.logo} text-8xl ${university.color} mb-6"></i>
                        <h3 class="text-4xl font-black text-slate-800 mb-2 font-game">${university.name}</h3>
                        <span class="bg-indigo-100 text-indigo-700 px-6 py-2 rounded-full font-bold font-game text-xl">${university.method} í•©ê²©</span>
                        <p class="mt-8 text-slate-500 text-center font-cute text-2xl font-bold leading-relaxed">
                            ìœ„ í•™ìƒì€ 2026í•™ë…„ë„ ëŒ€í•™ì…í•™ì „í˜•ì— ìµœì¢… í•©ê²©í•˜ì—¬<br>ë³¸êµì˜ ìë‘ìŠ¤ëŸ¬ìš´ ì‹ ì…ìƒì´ ë˜ì—ˆìŒì„ ì¦ëª…í•©ë‹ˆë‹¤.
                        </p>
                    </div>
                `;
            }
            playSuccessSound();
        }

        // Retry Handlers (Fixed)
        window.triggerJaesu = () => {
            if(confirm("ì¬ìˆ˜ë¥¼ ì„ íƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\në‚´ì‹  ë“±ê¸‰ì´ 0.5 í•˜ë½í•œ ìƒíƒœë¡œ ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤.")) {
                localStorage.setItem('retryMode', 'jaesu');
                location.reload();
            }
        };
        window.triggerGunsu = () => {
            if(confirm("êµ°ëŒ€ë¥¼ ì„ íƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\në‚´ì‹ ì´ 0.7 í•˜ë½í•˜ì§€ë§Œ, 10ë²ˆì˜ í€´ì¦ˆ ê¸°íšŒê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤.")) {
                localStorage.setItem('retryMode', 'gunsu');
                location.reload();
            }
        };
        window.triggerEnd = (type) => {
            alert(type === 'army' ? "êµ­ë°©ì˜ ì˜ë¬´ë¥¼ ë‹¤í•˜ëŸ¬ ë– ë‚©ë‹ˆë‹¤... ì¶©ì„±!" : "ê³ ì¡¸ì˜ ì‹ ë¶„ìœ¼ë¡œ ì‚¬íšŒì— ì²«ë°œì„ ë‚´ë”›ìŠµë‹ˆë‹¤.");
            location.reload();
        };

    </script>
</body>
</html>
